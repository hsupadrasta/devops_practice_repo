import csv
from selenium import webdriver

# Initialize WebDriver
driver = webdriver.Chrome(executable_path='/path/to/chromedriver')
driver.get('https://example.com')  # Replace with your URL

# Get all elements
elements = driver.find_elements_by_xpath("//*")

# Function to get the center point of an element
def get_center(element):
    rect = element.rect
    return (rect["x"] + rect["width"] / 2, rect["y"] + rect["height"] / 2)

# Identify leaf elements
leaf_elements = [element for element in elements if not element.find_elements_by_xpath(".//*")]

# Precompute centers for leaf elements
centers = {element: get_center(element) for element in leaf_elements}

# Function to find the closest element in a given direction
def find_closest(element, elements, direction):
    closest = None
    closest_distance = float("inf")
    x, y = centers[element]

    for other in elements:
        if other == element:
            continue  # Skip the same element
        other_x, other_y = centers[other]
        # ... rest of your code ...

# Open CSV file for writing
with open('elements.csv', 'w', newline='', encoding="UTF-8") as file:
    writer = csv.writer(file)
    writer.writerow(["Index", "Tag", "Location", "Area", "Text", "Class", "Top", "Bottom", "Left", "Right"])

    for index, element in enumerate(leaf_elements):
        # ... rest of your code ...

# Quit the driver
driver.quit()
