Set Outlook = CreateObject("Outlook.Application")
Set Mail = Outlook.CreateItem(0)

' Set email properties
Mail.Subject = "Test Email"
Mail.Body = "This is a test email sent from VBScript."
Mail.To = "recipient@example.com"

' Send the email
Mail.Send

' Wait for the email to be sent and appear in the Sent Items folder
WScript.Sleep 5000

' Access the Sent Items folder
Set Namespace = Outlook.GetNamespace("MAPI")
Set SentItems = Namespace.GetDefaultFolder(5).Items

' Find and delete the sent email
For Each Item In SentItems
    If Item.Subject = "Test Email" And Item.Body = "This is a test email sent from VBScript." Then
        Item.Delete
        Exit For
    End If
Next

Set Mail = Nothing
Set Outlook = Nothing
